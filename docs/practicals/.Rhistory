group_by(adult_child, cond_dist_features, pre_post) %>%
summarise( n_tp = length(target_abs_pres == "present"),
sum(correct_id[confidence_rating >= 4]), length( which(confidence_rating >=4)   ),
sum(correct_id[confidence_rating >= 3]), length( which(confidence_rating >=3)   ),
sum(correct_id[confidence_rating >= 2]), length( which(confidence_rating >=2)   ),
sum(correct_id[confidence_rating >= 1]), length( which(confidence_rating >=1)   ),
sum(correct_id[confidence_rating >= 0]), length( which(confidence_rating >=0)   ),
) %>% view()
HR <- data_summary %>%
#filter(target_abs_pres == "present") %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_tp = length(target_abs_pres == "present"),
HR4 = sum(correct_id[confidence_rating >= 4])/n_tp  ,
HR3 = sum(correct_id[confidence_rating >= 3])/n_tp    ,
HR2 = sum(correct_id[confidence_rating >= 2])/n_tp  ,
HR1 = sum(correct_id[confidence_rating >= 1])/n_tp ,
HR0 = sum(correct_id[confidence_rating >= 0])/n_tp
) %>%
ungroup()
HR <- HR %>%
mutate_all(~replace(., is.nan(.), 0))
# Calculate FAR (post)
data_summary %>%
#  filter(target_abs_pres == "absent") %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
sum(false_id[confidence_rating >= 4] ),
sum(false_id[confidence_rating >= 3] ),
sum(false_id[confidence_rating >= 2] ),
sum(false_id[confidence_rating >= 1] ),
sum(false_id[confidence_rating >= 0] ))  %>%
view()
FAR <- data_summary %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
FAR4 = sum(false_id[confidence_rating >= 4])/9/n_ta,
FAR3 = sum(false_id[confidence_rating >= 3])/9/n_ta,
FAR2 = sum(false_id[confidence_rating >= 2])/9/n_ta,
FAR1 = sum(false_id[confidence_rating >= 1])/9/n_ta,
FAR0 = sum(false_id[confidence_rating >= 0])/9/n_ta,
)  %>%
ungroup()
FAR <- FAR %>%
mutate_all(~replace(., is.nan(.), 0))
# join data
ROC_data <- left_join(HR, FAR)
ROC_data <- ROC_data %>% select(-n_tp,-n_ta)
ROC_data <- ROC_data %>%
pivot_longer(cols = HR4:FAR0, names_to = c("test","confidence_rating"), names_pattern = "(.*)(\\d+)") %>%
pivot_wider(names_from = test, values_from = value )
# try a plot
ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() +
facet_wrap(pre_post~adult_child)
# set.seed(123)
#
# test_data <- dataFrame %>%
#   filter(phase == "lineup") %>%
#   select(PID, cond_dist_features, target_abs_pres, correct_id)
#
# test_data$target_abs_pres <- as.factor(test_data$target_abs_pres)
# test_data$correct_id <- as.factor(test_data$correct_id)
# test_data$PID <- as.factor(test_data$PID)
#
#
# set.seed(123)
# data_split <- initial_split(test_data, strata = correct_id)
# data_train <- training(data_split)
# data_test <- testing(data_split)
#
# set.seed(234)
# data_folds <- vfold_cv(data_train, strata = correct_id)
#
# # build model
#
# mixed_model_spec <- logistic_reg() %>% set_engine("glmer")
# rec_basic <- recipe(correct_id ~ ., data = test_data, family="binomial")
#
# library(multilevelmod)
#
# wflow <-
#   workflow() %>%
#   add_recipe(rec_basic) %>%
#   add_model(mixed_model_spec, formula = correct_id ~  target_abs_pres + cond_dist_features + (1|PID))
#
# doParallel::registerDoParallel()
#
# ctrl_preds <- control_resamples(save_pred = T)
# rs <- fit_resamples(wflow, data_folds, control = ctrl_preds)
#
# augment(rs) %>%
#   roc_curve(correct_id, .pred_TRUE) %>%
#   autoplot()
#
# model_fit<- fit(wflow, data_train)
#
# glance(model_fit)
#
#
# #### get dataset of predictions
#
# pred_data <- augment(model_fit, test_data)
#
# #### Confusion matrix
#
# conf_mat(pred_data, truth = correct_id, estimate = .pred_class)
#
# #### model performance
#
# perf <- metric_set(accuracy,
#                    sensitivity,
#                    specificity,
#                    mcc,
#                    precision,
#                    recall)
#
#
# perf(pred_data, truth = correct_id, estimate = .pred_class)
#
# #### ROC
#
# roc_auc(pred_data, truth = correct_id, .pred_TRUE, event_level = "second") %>%
#    autoplot()
#
#
# pred_data %>%
#   roc_curve(correct_id, .pred_TRUE, event_level = "second") %>%
#   autoplot()
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes()) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line(aes(line = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating, shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
View(data_summary)
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(count(make_id))
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(count(made_id))
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(sum(made_id))
data_summary %>%
group_by(cond_dist_features, target_abs_pres, adult_child) %>%
summarise(sum(made_id))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot <- ROC_data %>%
filter(adult_child == "child")
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot <- ROC_data %>%
filter(adult_child == "child") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot
roc_plot <- ROC_data %>%
filter(adult_child == "child") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)  + facet_wrap(pre_post~.)
roc_plot
data_summary %>%
filter(adult_child == "child") %>%
group_by(cond_dist_features, target_abs_pres) %>%
summarise(sum(made_id), sum(correct_id), sum(false_id))
data_summary %>%
filter(adult_child == "child") %>%
group_by(cond_dist_features, target_abs_pres) %>%
summarise(sum(made_id), sum(correct_id), sum(false_id), sum(correct))
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
0.1/0.3
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = -.33)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) %>% jtools::theme_apa()
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa()
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot_pre
roc_plot_post
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post
ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .5)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .5)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post
0.3 / 0.1
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post
roc_plot_pre
roc_plot_pre1 <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post1 <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_pre1
FAR <- data_summary %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
FAR4 = (sum(false_id[confidence_rating >= 4])/9)/n_ta,
FAR3 = (sum(false_id[confidence_rating >= 3])/9)/n_ta,
FAR2 = (sum(false_id[confidence_rating >= 2])/9)/n_ta,
FAR1 = (sum(false_id[confidence_rating >= 1])/9)/n_ta,
FAR0 = (sum(false_id[confidence_rating >= 0])/9)/n_ta,
)  %>%
ungroup()
FAR <- FAR %>%
mutate_all(~replace(., is.nan(.), 0))
ROC_data <- left_join(HR, FAR)
ROC_data <- ROC_data %>% select(-n_tp,-n_ta)
ROC_data <- ROC_data %>%
pivot_longer(cols = HR4:FAR0, names_to = c("test","confidence_rating"), names_pattern = "(.*)(\\d+)") %>%
pivot_wider(names_from = test, values_from = value )
roc_plot_pre1 <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre1
roc_plot_post1 <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post1
roc_plot_pre1
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre
roc_plot_pre1
roc_plot_pre
roc_plot_pre1
roc_plot_post1
library(webexercises)
practical2_data <- read.csv("practical2_data.csv")
library(dplyr) #<1>
data_over18 <- practical2_data |> filter( age > 18) #<1>
n_over18 <- practical2_data |> filter( age > 18) |> count() #<2>
data_over18 |> group_by(treatment_group) |> summarise(mean_age = mean(age)) #<1>
library(webexercises)
practical2_data <- read.csv("practical2_data.csv")
library(dplyr) #<1>
data_over18 <- practical2_data |> filter( age > 18) #<1>
n_over18 <- practical2_data |> filter( age > 18) |> count() #<2>
age_sd <- data_over18 |> group_by(treatment_group) |> summarise(sd_age = sd(age)) #<1>
mean_diff <- data_over18 |> #<1>
group_by(treatment_group) |> #<2>
summarise(mean_outcome = mean(outcome)) |> #<3>
pull(mean_outcome) |> #<4>
diff() #<5>
mean_diff
# calculate the variance of the each group
var_tg <- data_over18 |> filter(treatment_group == "Treatment") |> pull(outcome) |> var() #<1>
var_cg <- data_over18 |> filter(treatment_group == "Control")  |> pull(outcome) |> var()
# calculate the sample size of each group
n_tg <- data_over18 |> filter(treatment_group == "Treatment") |> nrow() #<2>
n_cg <- data_over18 |> filter(treatment_group == "Control") |> nrow()
# calculate the standard error of the difference between the means
se_diff <- sqrt((var_tg/n_tg) + (var_cg/n_cg)) #<3>
se_diff <- sqrt((var_cg+var_tg)/(n_cg+n_tg))
# calculate the standard error of the difference between the means
se_diff <- sqrt((var_tg/n_tg) + (var_cg/n_cg)) #<3>
se_diff2 <- sqrt((var_cg+var_tg)/(n_cg+n_tg))
setwd("~/GitHub/aprm23/docs/practicals")
library(webexercises)
# generate some data for simple linear regression
# set the seed so that the random numbers are the same each time
set.seed(1234)
# generate a factor variable with 3 levels: CBT, Control, ACT. There should be 120 observations in total
treatment <- factor(rep(c("CBT", "Control", "ACT"), each = 40))
# generate 100 random numbers from a normal distribution with mean 10 and standard deviation 2
avoidance <- rnorm(120, mean = 10, sd = 2) |> round(0)
# generate 100 random numbers from a normal distribution with mean 5 and standard deviation 1
depression <- x + rnorm(120, mean = 5, sd = 1) |> round(0)
# generate some data for simple linear regression
# set the seed so that the random numbers are the same each time
set.seed(1234)
# generate a factor variable with 3 levels: CBT, Control, ACT. There should be 120 observations in total
treatment <- factor(rep(c("CBT", "Control", "ACT"), each = 40))
# generate 100 random numbers from a normal distribution with mean 10 and standard deviation 2
avoidance <- rnorm(120, mean = 10, sd = 2) |> round(0)
# generate 100 random numbers from a normal distribution with mean 5 and standard deviation 1
depression <- avoidance + rnorm(120, mean = 5, sd = 1) |> round(0)
# store the data in a data frame
data <- data.frame(avoidance, depression)
# save the data to a .csv file
write.csv(data, "practicals/practical3_data.csv", row.names = FALSE)
# load the data
practical3_data <- read.csv("practical3_data.csv")
setwd("~/GitHub/aprm23/docs/practicals")
# plot the data
plot(avoidance ~ depression, data = practical3_data) #<1>
model <- lm(avoidance ~ depression, data = data) #<1>
summary(model) #<2>
plot(model)
View(practical3_data)
# generate some data for simple linear regression
# set the seed so that the random numbers are the same each time
set.seed(1234)
# generate a factor variable with 3 levels: CBT, Control, ACT. There should be 120 observations in total
treatment <- factor(rep(c("CBT", "Control", "ACT"), each = 40))
# generate 100 random numbers from a normal distribution with mean 10 and standard deviation 2
avoidance <- rnorm(120, mean = 10, sd = 2) |> round(0)
# generate 100 random numbers from a normal distribution with mean 5 and standard deviation 1
depression <- avoidance + rnorm(120, mean = 5, sd = 1) |> round(0)
# store the data in a data frame
data <- data.frame(avoidance, depression, treatment)
# save the data to a .csv file
write.csv(data, "practicals/practical3_data.csv", row.names = FALSE)
write.csv(data, "practical3_data.csv", row.names = FALSE)
# load the data
practical3_data <- read.csv("practical3_data.csv")
View(practical3_data)
model2 <- lm(avoidance ~ treatment + depression, data = data) #<1>
summary(model2) #<2>
