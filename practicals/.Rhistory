sum(correct_id[confidence_rating >= 4]), length( which(confidence_rating >=4)   ),
sum(correct_id[confidence_rating >= 3]), length( which(confidence_rating >=3)   ),
sum(correct_id[confidence_rating >= 2]), length( which(confidence_rating >=2)   ),
sum(correct_id[confidence_rating >= 1]), length( which(confidence_rating >=1)   ),
sum(correct_id[confidence_rating >= 0]), length( which(confidence_rating >=0)   ),
) %>% view()
HR <- data_summary %>%
#filter(target_abs_pres == "present") %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_tp = length(target_abs_pres == "present"),
HR4 = sum(correct_id[confidence_rating >= 4])/n_tp  ,
HR3 = sum(correct_id[confidence_rating >= 3])/n_tp    ,
HR2 = sum(correct_id[confidence_rating >= 2])/n_tp  ,
HR1 = sum(correct_id[confidence_rating >= 1])/n_tp ,
HR0 = sum(correct_id[confidence_rating >= 0])/n_tp
) %>%
ungroup()
HR <- HR %>%
mutate_all(~replace(., is.nan(.), 0))
# Calculate FAR (post)
data_summary %>%
#  filter(target_abs_pres == "absent") %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
sum(false_id[confidence_rating >= 4] ),
sum(false_id[confidence_rating >= 3] ),
sum(false_id[confidence_rating >= 2] ),
sum(false_id[confidence_rating >= 1] ),
sum(false_id[confidence_rating >= 0] ))  %>%
view()
FAR <- data_summary %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
FAR4 = sum(false_id[confidence_rating >= 4])/9/n_ta,
FAR3 = sum(false_id[confidence_rating >= 3])/9/n_ta,
FAR2 = sum(false_id[confidence_rating >= 2])/9/n_ta,
FAR1 = sum(false_id[confidence_rating >= 1])/9/n_ta,
FAR0 = sum(false_id[confidence_rating >= 0])/9/n_ta,
)  %>%
ungroup()
FAR <- FAR %>%
mutate_all(~replace(., is.nan(.), 0))
# join data
ROC_data <- left_join(HR, FAR)
ROC_data <- ROC_data %>% select(-n_tp,-n_ta)
ROC_data <- ROC_data %>%
pivot_longer(cols = HR4:FAR0, names_to = c("test","confidence_rating"), names_pattern = "(.*)(\\d+)") %>%
pivot_wider(names_from = test, values_from = value )
# try a plot
ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() +
facet_wrap(pre_post~adult_child)
# set.seed(123)
#
# test_data <- dataFrame %>%
#   filter(phase == "lineup") %>%
#   select(PID, cond_dist_features, target_abs_pres, correct_id)
#
# test_data$target_abs_pres <- as.factor(test_data$target_abs_pres)
# test_data$correct_id <- as.factor(test_data$correct_id)
# test_data$PID <- as.factor(test_data$PID)
#
#
# set.seed(123)
# data_split <- initial_split(test_data, strata = correct_id)
# data_train <- training(data_split)
# data_test <- testing(data_split)
#
# set.seed(234)
# data_folds <- vfold_cv(data_train, strata = correct_id)
#
# # build model
#
# mixed_model_spec <- logistic_reg() %>% set_engine("glmer")
# rec_basic <- recipe(correct_id ~ ., data = test_data, family="binomial")
#
# library(multilevelmod)
#
# wflow <-
#   workflow() %>%
#   add_recipe(rec_basic) %>%
#   add_model(mixed_model_spec, formula = correct_id ~  target_abs_pres + cond_dist_features + (1|PID))
#
# doParallel::registerDoParallel()
#
# ctrl_preds <- control_resamples(save_pred = T)
# rs <- fit_resamples(wflow, data_folds, control = ctrl_preds)
#
# augment(rs) %>%
#   roc_curve(correct_id, .pred_TRUE) %>%
#   autoplot()
#
# model_fit<- fit(wflow, data_train)
#
# glance(model_fit)
#
#
# #### get dataset of predictions
#
# pred_data <- augment(model_fit, test_data)
#
# #### Confusion matrix
#
# conf_mat(pred_data, truth = correct_id, estimate = .pred_class)
#
# #### model performance
#
# perf <- metric_set(accuracy,
#                    sensitivity,
#                    specificity,
#                    mcc,
#                    precision,
#                    recall)
#
#
# perf(pred_data, truth = correct_id, estimate = .pred_class)
#
# #### ROC
#
# roc_auc(pred_data, truth = correct_id, .pred_TRUE, event_level = "second") %>%
#    autoplot()
#
#
# pred_data %>%
#   roc_curve(correct_id, .pred_TRUE, event_level = "second") %>%
#   autoplot()
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes()) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = confidence_rating)) + geom_line() + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line(aes(line = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(size = confidence_rating, shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child) +lims(x = c(0,0.3), y = c(0,0.3))
roc_plot
View(data_summary)
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(count(make_id))
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(count(made_id))
data_summary %>%
group_by(cond_dist_features, adult_child) %>%
summarise(sum(made_id))
data_summary %>%
group_by(cond_dist_features, target_abs_pres, adult_child) %>%
summarise(sum(made_id))
roc_plot
roc_plot <- ROC_data %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1) +
facet_wrap(pre_post~adult_child)
roc_plot
roc_plot
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot <- ROC_data %>%
filter(adult_child == "child")
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot <- ROC_data %>%
filter(adult_child == "child") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)
roc_plot
roc_plot <- ROC_data %>%
filter(adult_child == "child") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) + geom_abline(intercept = 0, slope = 1)  + facet_wrap(pre_post~.)
roc_plot
data_summary %>%
filter(adult_child == "child") %>%
group_by(cond_dist_features, target_abs_pres) %>%
summarise(sum(made_id), sum(correct_id), sum(false_id))
data_summary %>%
filter(adult_child == "child") %>%
group_by(cond_dist_features, target_abs_pres) %>%
summarise(sum(made_id), sum(correct_id), sum(false_id), sum(correct))
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.)
roc_plot
0.1/0.3
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = -.33)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.)
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) %>% jtools::theme_apa()
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa()
roc_plot
roc_plot <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate")
roc_plot_pre
roc_plot_post
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .33)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post
ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .5)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = .5)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post
0.3 / 0.1
roc_plot_post <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post
roc_plot_pre
roc_plot_pre1 <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_post1 <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_pre1
FAR <- data_summary %>%
group_by(adult_child, cond_dist_features, pre_post) %>%
summarise(n_ta = length(target_abs_pres == "absent"),
FAR4 = (sum(false_id[confidence_rating >= 4])/9)/n_ta,
FAR3 = (sum(false_id[confidence_rating >= 3])/9)/n_ta,
FAR2 = (sum(false_id[confidence_rating >= 2])/9)/n_ta,
FAR1 = (sum(false_id[confidence_rating >= 1])/9)/n_ta,
FAR0 = (sum(false_id[confidence_rating >= 0])/9)/n_ta,
)  %>%
ungroup()
FAR <- FAR %>%
mutate_all(~replace(., is.nan(.), 0))
ROC_data <- left_join(HR, FAR)
ROC_data <- ROC_data %>% select(-n_tp,-n_ta)
ROC_data <- ROC_data %>%
pivot_longer(cols = HR4:FAR0, names_to = c("test","confidence_rating"), names_pattern = "(.*)(\\d+)") %>%
pivot_wider(names_from = test, values_from = value )
roc_plot_pre1 <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre1
roc_plot_post1 <- ROC_data %>%
filter(pre_post == "confidence_post") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.3), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 1)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Post-lineup")
roc_plot_post1
roc_plot_pre1
roc_plot_pre <- ROC_data %>%
filter(pre_post == "confidence_pre") %>%
ggplot(aes(x = FAR, y = HR, color = cond_dist_features)) +
geom_point(aes(shape = cond_dist_features)) + geom_line(aes(linetype = cond_dist_features)) +
lims(x = c(0,0.1), y = c(0,0.3)) +
geom_abline(intercept = 0, slope = 3)  + facet_wrap(adult_child ~.) + jtools::theme_apa() +
labs(x = "False Identification Rate", y="Correct Identification Rate", title = "ROC: Confidence Ratings Pre-lineup")
roc_plot_pre
roc_plot_pre1
roc_plot_pre
roc_plot_pre1
roc_plot_post1
setwd("~/GitHub/aprm23/practicals")
# Generate a dataset with two columns called "Treatment" and "Control" with 1000 rows. The values in the columns should be random normal values with a mean of 10.5 and 12.5 respectively, and a standard deviation of 3.5 and 1.5 respectively.
group1 <- rnorm(1000, 10.5, 3.5)
group2 <- rnorm(1000, 12.5, 1.5)
practical2_data <- data.frame(Treatment = group1, Control = group2)
write.csv(practical2_data, "practical2_data.csv", row.names = FALSE)
practical2_data <- read.csv("practical2_data.csv")
# calculate the difference between the means
meanDiff <- mean(group1) - mean(group2)
standardError <- sqrt((var(group1) / length(group1)) + (var(group2) / length(group2)))
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
confidenceInterval
standardError <- sqrt((var(group1) / length(group1)) + (var(group2) / length(group2)))
# calculate the confidence interval
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
confidenceInterval[0]
confidenceInterval[1]
confidenceInterval[2]
confidenceInterval
standardError <- sqrt((var(practical2_data$group1) / length(practical2_data$group1)) + (var(practical2_data$group2) / practical2_data$length(group2)))
standardError <- sqrt((var(practical2_data$Treatment) / length(practical2_data$Treatment)) + (var(practical2_data$Control) / practical2_data$length(Control)))
standardError <- sqrt((var(practical2_data$Treatment) / length(practical2_data$Treatment)) + (var(practical2_data$Control) / length(practical2_data$Control)))
# calculate the confidence interval
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
power.t.test(d = effectSize, sig.level = 0.05, power = 0.8, type = "two.sample")
effectSize <- meanDiff / polled_sd
effectSize <- meanDiff / pooled_sd
pooled_sd <- sqrt(((length(practical2_data$Treatment) - 1) * var(practical2_data$Treatment)) + ((length(practical2_data$Control) - 1) * var(practical2_data$Control))) / (length(practical2_data$Treatment) + length(practical2_data$Control) - 2)
effectSize <- meanDiff / pooled_sd
power.t.test(d = effectSize, sig.level = 0.05, power = 0.8, type = "two.sample")
mean(practical2_data$Treatment)
sd(practical2_data$Treatment)
length(practical2_data$Treatment)
mean(practical2_data$Control)
sd(practical2_data$Control)
pooled_sd <- sqrt(((length(practical2_data$Treatment) - 1) * var(practical2_data$Treatment)) + ((length(practical2_data$Control) - 1) * var(practical2_data$Control))) / (length(practical2_data$Treatment) + length(practical2_data$Control) - 2)
pooled_sd
#find sample standard deviation of each sample
s1 <- sd(practical2_data$Treatment)
s2 <- sd(practical2_data$Control)
#find sample size of each sample
n1 <- length(practical2_data$Treatment)
n2 <- length(practical2_data$Control)
pooled_sd <-sqrt(((n1-1)*s1^2 + (n2-1)*s2^2) / (n1+n1-2))
pooled_sd
s2^2
var(practical2_data$Control)
practical2_data <- read.csv("practical2_data.csv")
library(webexercises)
meanDiff <- mean(practical2_data$Treatment) - mean(practical2_data$Control)
se1 <- sd(practical2_data$Treatment) / length(practical2_data$Treatment)
standardError <- sqrt((var(practical2_data$Treatment) / length(practical2_data$Treatment)) + (var(practical2_data$Control) / length(practical2_data$Control)))
# calculate the confidence interval
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
step1 <- length(practical2_data$Treatment) - 1 * var(practical2_data$Treatment)
step2 <- length(practical2_data$Control) - 1 * var(practical2_data$Control)
step3 <- step1 + step2
step4 <- length(practical2_data$Treatment) + length(practical2_data$Control) - 2
practical2_data <- read.csv("practical2_data.csv")
library(webexercises)
meanDiff <- mean(practical2_data$Treatment) - mean(practical2_data$Control)
se1 <- sd(practical2_data$Treatment) / length(practical2_data$Treatment)
standardError <- sqrt((var(practical2_data$Treatment) / length(practical2_data$Treatment)) + (var(practical2_data$Control) / length(practical2_data$Control)))
# calculate the confidence interval
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
step1 <- length(practical2_data$Treatment) - 1 * var(practical2_data$Treatment)
step2 <- length(practical2_data$Control) - 1 * var(practical2_data$Control)
step3 <- step1 + step2
step4 <- length(practical2_data$Treatment) + length(practical2_data$Control) - 2
step5 <- step3 / step4
practical2_data <- read.csv("practical2_data.csv")
library(webexercises)
meanDiff <- mean(practical2_data$Treatment) - mean(practical2_data$Control)
se1 <- sd(practical2_data$Treatment) / length(practical2_data$Treatment)
standardError <- sqrt((var(practical2_data$Treatment) / length(practical2_data$Treatment)) + (var(practical2_data$Control) / length(practical2_data$Control)))
# calculate the confidence interval
confidenceInterval <- meanDiff + c(-1, 1) * 1.96 * standardError
step1 <- length(practical2_data$Treatment) - 1 * var(practical2_data$Treatment)
step2 <- length(practical2_data$Control) - 1 * var(practical2_data$Control)
step3 <- step1 + step2
step4 <- length(practical2_data$Treatment) + length(practical2_data$Control) - 2
step5 <- step3 / step4
step6 <- sqrt(step5)
step6
