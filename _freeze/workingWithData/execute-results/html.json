{
  "hash": "8bdc45b55f797407d0b412e56e7eeb7b",
  "result": {
    "markdown": "\n\n\n\n# Working with data in R\n\n<iframe src=\"https://teesside.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=4d1a880f-b435-465a-95a3-adaa00908325&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&captions=false&interactivity=all\" height=\"405\" width=\"100%\" style=\"border: 1px solid #464646;\" allowfullscreen allow=\"autoplay\"></iframe>\n\n## By the end of this section, you will be able to:\n- Import data into R from excel, SPSS and csv files\n- Save data to <a class='glossary'>object<span class='def'>A word that identifies and stores the value of some data for later use.</span></a>\n- Identify different data structures and <a class='glossary'>data types<span class='def'></span></a>\n- Convert <a class='glossary'>data types<span class='def'></span></a> from one type to another\n- Order, filter and group data\n- Summarise data\n- Create new <a class='glossary'>variables<span class='def'></span></a> or <a class='glossary'>objects<span class='def'>A word that identifies and stores the value of some data for later use.</span></a> from data\n\n\n## In this section, we will use the <pkg>Tidyverse</pkg> set of packages\n\n-\tA ‘toolkit’ of packages that are very useful for organsing and manipulating data\n- We will use the <pkg>haven</pkg> package to import SPSS files\n- We will use the <pkg>dplyr</pkg> to organise data\n- Also includes the <pkg>ggplot2</pkg> and <pkg>tidyR</pkg> packages which we will use later\n\nTo install: \n\n\n`install.packages(“tidyverse”)`\n\n(See the previous section on installing packages)\n\n## Import data into R from excel, SPSS and csv files\n\nWe can import data from a range of sources using the <if>Import Dataset<if> button in the <if>Environment<if> tab:\n\n![Importing data](images/importData.png)\n\nIt is also possible to import data using code, for example:\n\n\n`\n # importing a .csv file\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n   library(readr)\n    studentData <- read_csv(\"Datasets/studentData.csv\")\n\n    #importing an SPSS file\n    \n    library(haven)\n    mySPSSData <- read_sav(\"datasets/salesData.sav\")\n```\n:::\n\n\n\n\nOnce the data are imported, it will be visible in the environment: \n\n![Imported data in the environment](images/environment.png)\n\n## Restructuring and reorganising data in R (long versus wide data)\n\n<iframe src=\"https://teesside.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=59c0876a-8047-401c-826a-aaec00cbb220&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all\" height=\"405\" width=\"100%\" style=\"border: 1px solid #464646;\" allowfullscreen allow=\"autoplay\"></iframe>\n\n## Understanding objects in R\n\nIn R, an <a class='glossary'>object<span class='def'>A word that identifies and stores the value of some data for later use.</span></a> is anything that is saved to memory. For example, we might do some analysis:\n\n`mean(happiness)`\n\n     \nHowever, in the example above, the result would appear in the console but not be saved anywhere. To store the result for reuse later, we save it to an object: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhappinessMean <- mean(happiness)\n```\n:::\n\n\n\nIn the above code (reading left to right):\n\n- We name the object \"happinessMean\". This name can be anything we want.\n- The arrow means that the result of the code on the right will be saved to the object on the left.\n- The code on the right of the arrow calculates the mean of *happiness* data   \n    \nWhen this code is run, *happinessMean* will be stored in the environment window:\n\n![Storing the result of a calculation in the environment](images/saveobject.png)\n\nTo recall an object from the environment, we can simply type its name. For example:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n happinessMean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 10.29769\n```\n:::\n:::\n\n \n    \n> Its important to note that anything can be stored as an object in R and recalled later. This includes, dataframes, the results of statistical calculations, plots etc.\n\n## Identify different <a class='glossary'>data structures<span class='def'>A data structure that aggregates data, such as a vector, list, matrix, or data frame</span></a> and variable types\n\n### Data structures (sometimes referred to as \"<a class='glossary'>data containers<span class='def'>A data structure that aggregates data, such as a vector, list, matrix, or data frame</span></a>\")\n\nThere are many different types of data structures that R can work with. The most common type of data for most people tends to be a <a class='glossary'>data frame<span class='def'></span></a>. A <a class='glossary'>data frame<span class='def'></span></a> is what you might consider a \"normal\" 2-dimensional dataset, with rows of data and columns of variables:\n\n![A dataframe example](images/dataframe.png)\n\nR can also use other data structures.\n\nA <a class='glossary'>vector<span class='def'></span></a> is a one-dimensional set of values:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# a vector example\n\nscores <- c(1,4,6,8,3,4,6,7)\n```\n:::\n\n\nA <a class='glossary'>matrix<span class='def'></span></a> is a multi-dimensional set of values. The below example is a 3-dimensional matrix, there are 2 groups of 2 rows and 3 columns:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n, , 1\n\n     [,1] [,2] [,3]\n[1,]    1    3    5\n[2,]    2    4    6\n\n, , 2\n\n     [,1] [,2] [,3]\n[1,]    7    9   11\n[2,]    8   10   12\n```\n:::\n:::\n\n\n> We will primarily work with dataframes (and sometimes vectors), as this is how the data in psychology research is usually structured.\n\n### Types of numerical data\n\nWith numerical data, there are 4 key <a class='glossary'>data types<span class='def'></span></a>:\n\n- <a class='glossary'>factor (data type)<span class='def'></span></a> or nominal (a category, group or factor)\n- <a class='glossary'>ordinal<span class='def'>Discrete variables that have an inherent order, such as level of education or dislike/like.</span></a> (a ranking)\n- <a class='glossary'>interval (data type)<span class='def'></span></a> (scale data that can include negative values)\n- <a class='glossary'>ratio (data type)<span class='def'></span></a> (scale data that cannot include negative values)\n\n![Numerical data types](images/dataTypes.png)\nR can use all of these variable types:\n\n\n- **Nominal** variables are called **factors**\n- **Ordinal** variables are called **ordered factors**\n- **Interval and ratio** variables are called **numeric** data and can sometimes be called integers (if they are only whole numbers) or doubles (if they all have decimal points)\n\nR can also use other data types that are not numerical such as text (<a class='glossary'>character<span class='def'>A data type representing strings of text.</span></a>) data.\n\n### Convert variables from one data type to another\n\nWhen we first import data into R, it might not recognise the data types correctly. For example, in the below data, we can see the **intervention** variable :\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| participant| intervention| happiness|\n|-----------:|------------:|---------:|\n|           4|            2|  6.245260|\n|           7|            2|  8.745944|\n|           9|            2|  8.906846|\n|          13|            2|  9.199057|\n|           8|            2|  9.301780|\n|           5|            2|  9.381039|\n|          16|            1|  9.446345|\n|           3|            1|  9.909773|\n|          18|            2| 10.017880|\n|          17|            2| 10.075152|\n\n</div>\n:::\n:::\n\nIn the **intervention** variable, the numbers 1 and 2 refer to different intervention groups. Therefore, the variable is a <a class='glossary'>factor (data type)<span class='def'></span></a> variable. To ensure that R understands this, we can resave the intervention variable as a factor using the `as.factor()` function:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhappinessSample$intervention <- as.factor(happinessSample$intervention)\n```\n:::\n\n\n\n## Working with dataframes\n\n<a class='glossary'>Dataframes<span class='def'>a 2-dimensional dataset, usually with rows of data and columns of variables</span></a> are the more standard data format that were are used to (think of how a dataset looks in SPSS or Excel).\n\nIn a <a class='glossary'>dataframe<span class='def'>a 2-dimensional dataset, usually with rows of data and columns of variables</span></a>, variables are columns and each row usually reperesents one measurement or one participant.\n\n### View dataframe\n\nTo view a dataframe, we can click on it in the <inf>environment</inf> window and it will display:\n\n![Clicking on datasets in hte environment will open them up for viewing](images/environment.png)\n\n![Viewing a dataframe](images/dataframe.png)\n\n### Refer to variables (columns) in a dataframe\n\nColumns in a dataframe are accessed using the \"$\" sign. For example, to access the *happiness* column in the *happinessSample* dataframe, we would type:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhappinessSample$happiness\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 11.580517 11.947034  9.909773  6.245260  9.381039 11.515421  8.745944\n [8]  9.301780  8.906846 11.011479 10.726459 11.337853  9.199057 11.120169\n[15] 11.563120  9.446345 10.075152 10.017880 11.284192 12.638480\n```\n:::\n:::\n\n\nAs we can see above, the result is then displayed.\n\n## Order, filter and group data\n\nIf you have the <pkg>tidyverse</pkg> package loaded, it is easy to organise and filter data.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\narrange(happinessSample, happiness)\narrange(happinessSample, desc(happiness)) # Arrange in descending order\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| participant|intervention | happiness|\n|-----------:|:------------|---------:|\n|           4|2            |  6.245260|\n|           7|2            |  8.745944|\n|           9|2            |  8.906846|\n|          13|2            |  9.199057|\n|           8|2            |  9.301780|\n|           5|2            |  9.381039|\n|          16|1            |  9.446345|\n|           3|1            |  9.909773|\n|          18|2            | 10.017880|\n|          17|2            | 10.075152|\n|          11|2            | 10.726459|\n|          10|2            | 11.011479|\n|          14|1            | 11.120169|\n|          19|2            | 11.284192|\n|          12|1            | 11.337853|\n|           6|2            | 11.515421|\n|          15|2            | 11.563120|\n|           1|1            | 11.580517|\n|           2|1            | 11.947034|\n|          20|1            | 12.638480|\n\n</div><div class=\"kable-table\">\n\n| participant|intervention | happiness|\n|-----------:|:------------|---------:|\n|          20|1            | 12.638480|\n|           2|1            | 11.947034|\n|           1|1            | 11.580517|\n|          15|2            | 11.563120|\n|           6|2            | 11.515421|\n|          12|1            | 11.337853|\n|          19|2            | 11.284192|\n|          14|1            | 11.120169|\n|          10|2            | 11.011479|\n|          11|2            | 10.726459|\n|          17|2            | 10.075152|\n|          18|2            | 10.017880|\n|           3|1            |  9.909773|\n|          16|1            |  9.446345|\n|           5|2            |  9.381039|\n|           8|2            |  9.301780|\n|          13|2            |  9.199057|\n|           9|2            |  8.906846|\n|           7|2            |  8.745944|\n|           4|2            |  6.245260|\n\n</div>\n:::\n:::\n\n\n- Show clients with a happiness score of less than 4\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfilter(happinessSample, happiness < 4)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| participant|intervention | happiness|\n|-----------:|:------------|---------:|\n\n</div>\n:::\n:::\n\n\n- Show Intervention group 2 with happiness scores above 7\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfilter(happinessSample, happiness > 7 & intervention == 2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| participant|intervention | happiness|\n|-----------:|:------------|---------:|\n|           5|2            |  9.381039|\n|           6|2            | 11.515421|\n|           7|2            |  8.745944|\n|           8|2            |  9.301780|\n|           9|2            |  8.906846|\n|          10|2            | 11.011479|\n|          11|2            | 10.726459|\n|          13|2            |  9.199057|\n|          15|2            | 11.563120|\n|          17|2            | 10.075152|\n|          18|2            | 10.017880|\n|          19|2            | 11.284192|\n\n</div>\n:::\n:::\n\n\n- Group by intervention and show the mean happiness score\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhappinessSample %>% group_by(intervention) %>% summarise(mean = mean(happiness))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|intervention |      mean|\n|:------------|---------:|\n|1            | 11.140025|\n|2            |  9.844125|\n\n</div>\n:::\n:::\n\n\n\n## Create new variables / objects from data\n\nTo create new variables from data, we can use the **mutate()** function.\n\nFor example, let's say we wanted to calculate the difference between each person's happiness score and the mean happiness score.\n\nWe could do the following:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhappinessSample %>% mutate(difference = happiness - mean(happiness))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| participant|intervention | happiness| difference|\n|-----------:|:------------|---------:|----------:|\n|           1|1            | 11.580517|  1.2828274|\n|           2|1            | 11.947034|  1.6493438|\n|           3|1            |  9.909773| -0.3879166|\n|           4|2            |  6.245260| -4.0524304|\n|           5|2            |  9.381039| -0.9166514|\n|           6|2            | 11.515421|  1.2177310|\n|           7|2            |  8.745944| -1.5517460|\n|           8|2            |  9.301780| -0.9959098|\n|           9|2            |  8.906846| -1.3908438|\n|          10|2            | 11.011479|  0.7137887|\n|          11|2            | 10.726459|  0.4287693|\n|          12|1            | 11.337853|  1.0401634|\n|          13|2            |  9.199057| -1.0986329|\n|          14|1            | 11.120169|  0.8224791|\n|          15|2            | 11.563120|  1.2654296|\n|          16|1            |  9.446345| -0.8513449|\n|          17|2            | 10.075152| -0.2225381|\n|          18|2            | 10.017880| -0.2798103|\n|          19|2            | 11.284192|  0.9865019|\n|          20|1            | 12.638480|  2.3407900|\n\n</div>\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}